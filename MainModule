local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local DynaFlip = Instance.new("ScreenGui")
DynaFlip.Name = "DynaFlipAdminPanel"
DynaFlip.ResetOnSpawn = false
DynaFlip.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
DynaFlip.DisplayOrder = 999
DynaFlip.Parent = CoreGui

local DFButton = Instance.new("TextButton")
DFButton.Name = "DFCircleButton"
DFButton.Size = UDim2.new(0, 60, 0, 60)
DFButton.Position = UDim2.new(0, 20, 0.5, -30)
DFButton.AnchorPoint = Vector2.new(0, 0.5)
DFButton.BackgroundColor3 = Color3.new(0.18, 0.18, 0.24)
DFButton.Text = "DF"
DFButton.TextColor3 = Color3.new(1, 1, 1)
DFButton.Font = Enum.Font.GothamBlack
DFButton.TextSize = 24
DFButton.TextStrokeTransparency = 0
DFButton.TextStrokeColor3 = Color3.new(0.8, 0.8, 1)
DFButton.Parent = DynaFlip

local UICornerDF = Instance.new("UICorner")
UICornerDF.CornerRadius = UDim.new(1, 0)
UICornerDF.Parent = DFButton

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 350, 0, 400)
MainFrame.Position = UDim2.new(0.5, -175, 0.5, -200)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.new(0.12, 0.12, 0.16)
MainFrame.BackgroundTransparency = 0.1
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Visible = false
MainFrame.Parent = DynaFlip

local TopBar = Instance.new("Frame")
TopBar.Name = "TopBar"
TopBar.Size = UDim2.new(1, 0, 0, 40)
TopBar.Position = UDim2.new(0, 0, 0, 0)
TopBar.BackgroundColor3 = Color3.new(0.18, 0.18, 0.24)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(0, 200, 1, 0)
Title.Position = UDim2.new(0.5, -100, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "DynaFlip - لوحة التحكم"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.Parent = TopBar

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0.5, -15)
CloseButton.BackgroundColor3 = Color3.new(0.8, 0.24, 0.24)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 14
CloseButton.Parent = TopBar

local ButtonsContainer = Instance.new("ScrollingFrame")
ButtonsContainer.Name = "ButtonsContainer"
ButtonsContainer.Size = UDim2.new(1, -20, 1, -60)
ButtonsContainer.Position = UDim2.new(0, 10, 0, 50)
ButtonsContainer.BackgroundTransparency = 1
ButtonsContainer.ScrollBarThickness = 5
ButtonsContainer.CanvasSize = UDim2.new(0, 0, 0, 500)
ButtonsContainer.Parent = MainFrame

local function CreateButton(text, color)
    local Button = Instance.new("TextButton")
    Button.Name = text.."Button"
    Button.Size = UDim2.new(1, 0, 0, 50)
    Button.BackgroundColor3 = color
    Button.Text = text
    Button.TextColor3 = Color3.new(1, 1, 1)
    Button.Font = Enum.Font.GothamBold
    Button.TextSize = 16
    Button.AutoButtonColor = false
    Button.Parent = ButtonsContainer
    return Button
end

local FlyButton = CreateButton("الطيران (Fly)", Color3.new(0, 0.47, 0.84))
local NoClipButton = CreateButton("المرور عبر الأشياء (NoClip)", Color3.new(0, 0.71, 0.47))
local BtoolsButton = CreateButton("أدوات البناء (Btools)", Color3.new(0.86, 0.63, 0))
local ServerLockButton = CreateButton("قفل السيرفر (ServerLock)", Color3.new(0.71, 0, 0))
local ShutdownButton = CreateButton("إيقاف السيرفر (Shutdown)", Color3.new(0.59, 0, 0.31))

local function ToggleMainFrame()
    MainFrame.Visible = not MainFrame.Visible
end

local function Fly()
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Flying)
        end
    end
end

local function NoClip()
    local character = LocalPlayer.Character
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end

local function GiveBtools()
    local backpack = LocalPlayer:FindFirstChildOfClass("Backpack")
    if backpack then
        local hammer = Instance.new("HopperBin")
        hammer.BinType = Enum.BinType.Hammer
        hammer.Parent = backpack
        
        local clone = Instance.new("HopperBin")
        clone.BinType = Enum.BinType.Clone
        clone.Parent = backpack
    end
end

local function ServerLock()
    pcall(function()
        game:GetService("ReplicatedStorage"):FindFirstChild("SetServerLocked", true).Value = true
    end)
end

local function ShutdownServer()
    pcall(function()
        game:GetService("ReplicatedStorage"):FindFirstChild("ShutdownServer", true):FireServer()
    end)
end

DFButton.MouseButton1Click:Connect(ToggleMainFrame)
CloseButton.MouseButton1Click:Connect(function() MainFrame.Visible = false end)
FlyButton.MouseButton1Click:Connect(Fly)
NoClipButton.MouseButton1Click:Connect(NoClip)
BtoolsButton.MouseButton1Click:Connect(GiveBtools)
ServerLockButton.MouseButton1Click:Connect(ServerLock)
ShutdownButton.MouseButton1Click:Connect(ShutdownServer)

DFButton.Visible = true