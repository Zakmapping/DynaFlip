-- نسخة DynaFlip المعدلة للعمل في الألعاب العشوائية
if not game:IsLoaded() then game.Loaded:Wait() end

local function SafeWaitForService(serviceName)
    local service
    repeat
        service = game:GetService(serviceName)
        task.wait()
    until service
    return service
end

local Players = SafeWaitForService("Players")
local CoreGui = SafeWaitForService("CoreGui")
local TweenService = SafeWaitForService("TweenService")
local RunService = SafeWaitForService("RunService")

local LocalPlayer = Players.LocalPlayer
while not LocalPlayer do
    task.wait()
    LocalPlayer = Players.LocalPlayer
end

-- إنشاء الواجهة
local DynaFlip = Instance.new("ScreenGui")
DynaFlip.Name = "DynaFlipMobileAdmin"
DynaFlip.ResetOnSpawn = false
DynaFlip.Parent = CoreGui

-- زر التشغيل الرئيسي (DF)
local DFButton = Instance.new("TextButton")
DFButton.Name = "DFButton"
DFButton.Size = UDim2.new(0, 60, 0, 60)
DFButton.Position = UDim2.new(0, 20, 0.5, -30)
DFButton.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
DFButton.Text = "DF"
DFButton.TextColor3 = Color3.new(1,1,1)
DFButton.Font = Enum.Font.GothamBlack
DFButton.TextSize = 18
DFButton.Parent = DynaFlip

-- تأثير دائري للزر
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(1,0)
UICorner.Parent = DFButton

-- الواجهة الرئيسية
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 300, 0, 350)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -175)
MainFrame.BackgroundColor3 = Color3.fromRGB(40,40,50)
MainFrame.BackgroundTransparency = 0.1
MainFrame.Visible = false
MainFrame.Parent = DynaFlip

-- قائمة الأوامر
local commands = {
    {"Fly", Color3.fromRGB(0, 150, 200), function()
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Flying)
        end
    end},
    
    {"NoClip", Color3.fromRGB(0, 180, 120), function()
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end},
    
    {"Btools", Color3.fromRGB(220, 160, 0), function()
        local tool1 = Instance.new("HopperBin")
        tool1.BinType = Enum.BinType.Hammer
        tool1.Parent = LocalPlayer.Backpack
        
        local tool2 = Instance.new("HopperBin")
        tool2.BinType = Enum.BinType.Clone
        tool2.Parent = LocalPlayer.Backpack
    end},
    
    {"Kill All", Color3.fromRGB(180, 0, 0), function()
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                local humanoid = player.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.Health = 0
                end
            end
        end
    end}
}

-- إنشاء أزرار الأوامر
local buttonTemplate = Instance.new("TextButton")
buttonTemplate.Size = UDim2.new(0.9, 0, 0, 45)
buttonTemplate.Font = Enum.Font.GothamBold
buttonTemplate.TextSize = 16
buttonTemplate.AutoButtonColor = false

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.Parent = MainFrame

for i, cmd in ipairs(commands) do
    local newButton = buttonTemplate:Clone()
    newButton.Text = cmd[1]
    newButton.BackgroundColor3 = cmd[2]
    newButton.Position = UDim2.new(0.05, 0, 0, (i-1)*50 + 10)
    newButton.Parent = MainFrame
    
    local corner = Instance.new("UICorner")
    corner.Parent = newButton
    
    newButton.MouseButton1Click:Connect(function()
        pcall(cmd[3]) -- تنفيذ الأمر مع معالجة الأخطاء
    end)
end

-- التحكم في إظهار/إخفاء الواجهة
DFButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- التأكد من ظهور الزر
DFButton.Visible = true